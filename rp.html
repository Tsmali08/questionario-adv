<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>Questionário Pré-Treino/Jogo</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    select, input[type="number"] {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
    }
    button {
      margin-top: 20px;
      padding: 10px;
      width: 100%;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
    }
    th {
      background-color: #eee;
    }
    .delete-btn {
      color: red;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <img src="imagens/adv.png" alt="Logo do Clube" style="max-width: 200px; display: block; margin: auto;">
  <h1>ADV Juniores 2025/2026</h1>
  <h4>Questionário Pré-Treino/Jogo</h4>

  <label for="jogador">Nome do jogador:</label>
  <select id="jogador">
    <option>Diogo Tavares</option>
    <option>Diogo Bastos</option>
    <option>Hugo Pinho</option>
    <option>Rodrigo Matos</option>
    <option>Rodrigo Almeida</option>
  </select>

  <label for="tipo">Tipo de atividade:</label>
  <select id="tipo">
    <option>Treino</option>
    <option>Jogo</option>
  </select>

  <label for="sono">Qualidade do sono (1-5):</label>
  <input type="number" id="sono" min="1" max="5" required>

  <label for="fadiga">Fadiga (1-5):</label>
  <input type="number" id="fadiga" min="1" max="5" required>

  <label for="dor">Dor muscular (1-5):</label>
  <input type="number" id="dor" min="1" max="5" required>

  <label for="stress">Stress (1-5):</label>
  <input type="number" id="stress" min="1" max="5" required>

  <label for="saude">Saúde (1-5):</label>
  <input type="number" id="saude" min="1" max="5" required>

  <label for="humor">Estado de humor (1-5):</label>
  <input type="number" id="humor" min="1" max="5" required>

  <label for="motivacao">Motivação e Entusiasmo para treinar (1-5):</label>
  <input type="number" id="motivacao" min="1" max="5" required>

  <button onclick="salvarRespostas()">Enviar Respostas</button>
  <button onclick="pedirSenha()">Ver Respostas (Admin)</button>

  <div id="tabelaRespostas"></div>

  <script>
    // CONFIGURE AQUI O SEU FIREBASE
    const firebaseConfig = {
      apiKey: "SUA_API_KEY",
      authDomain: "SEU_DOMINIO.firebaseapp.com",
      projectId: "SEU_PROJECT_ID",
      storageBucket: "SEU_BUCKET.appspot.com",
      messagingSenderId: "SEU_ID",
      appId: "SEU_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function salvarRespostas() {
      const data = new Date();
      const dataFormatada = data.toLocaleDateString('pt-PT');

      const resposta = {
        data: dataFormatada,
        jogador: document.getElementById('jogador').value,
        tipo: document.getElementById('tipo').value,
        sono: document.getElementById('sono').value,
        fadiga: document.getElementById('fadiga').value,
        dor: document.getElementById('dor').value,
        stress: document.getElementById('stress').value,
        saude: document.getElementById('saude').value,
        humor: document.getElementById('humor').value,
        motivacao: document.getElementById('motivacao').value
      };

      db.collection("respostas").add(resposta).then(() => {
        alert("Respostas enviadas com sucesso!");
        document.querySelectorAll("input").forEach(el => el.value = "");
      });
    }

    function pedirSenha() {
      const senha = prompt("Digite a senha para ver as respostas:");
      if (senha === "admin123") {
        mostrarTabela();
      } else {
        alert("Senha incorreta!");
      }
    }

    async function mostrarTabela() {
      const querySnapshot = await db.collection("respostas").get();
      const dados = {};

      querySnapshot.forEach(doc => {
        const r = doc.data();
        if (!dados[r.data]) dados[r.data] = {};
        dados[r.data][r.jogador] = r;
      });

      const jogadores = ["Diogo Tavares", "Diogo Bastos", "Hugo Pinho", "Rodrigo Matos", "Rodrigo Almeida"];
      let html = "<h3>Respostas por Dia</h3>";
      html += '<button onclick="baixarPDF()">Baixar PDF</button>';

      for (const dia in dados) {
        html += `<h4>${dia}</h4><table><thead><tr><th>Jogador</th><th>Tipo</th><th>Sono</th><th>Fadiga</th><th>Dor</th><th>Stress</th><th>Saúde</th><th>Humor</th><th>Motivação</th></tr></thead><tbody>`;
        jogadores.forEach(j => {
          const r = dados[dia][j];
          if (r) {
            html += `<tr><td>${j}</td><td>${r.tipo}</td><td>${r.sono}</td><td>${r.fadiga}</td><td>${r.dor}</td><td>${r.stress}</td><td>${r.saude}</td><td>${r.humor}</td><td>${r.motivacao}</td></tr>`;
          } else {
            html += `<tr><td>${j}</td><td colspan="8">Não respondeu</td></tr>`;
          }
        });
        html += `</tbody></table>`;
      }

      document.getElementById("tabelaRespostas").innerHTML = html;
    }

    async function baixarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const querySnapshot = await db.collection("respostas").get();
      const dados = {};

      querySnapshot.forEach(docSnap => {
        const r = docSnap.data();
        if (!dados[r.data]) dados[r.data] = {};
        dados[r.data][r.jogador] = r;
      });

      const jogadores = ["Diogo Tavares", "Diogo Bastos", "Hugo Pinho", "Rodrigo Matos", "Rodrigo Almeida"];
      let y = 10;

      for (const dia in dados) {
        doc.setFontSize(14);
        doc.text(`Dia: ${dia}`, 10, y);
        y += 8;
        doc.setFontSize(10);
        jogadores.forEach(j => {
          const r = dados[dia][j];
          const linha = r ? `${j} - ${r.tipo} | Sono: ${r.sono}, Fadiga: ${r.fadiga}, Dor: ${r.dor}, Stress: ${r.stress}, Saúde: ${r.saude}, Humor: ${r.humor}, Motivação: ${r.motivacao}` : `${j} - Não respondeu`;
          doc.text(linha, 10, y);
          y += 6;
          if (y > 280) {
            doc.addPage();
            y = 10;
          }
        });
        y += 8;
      }

      doc.save("respostas_por_dia.pdf");
    }
  </script>
</body>
</html>
